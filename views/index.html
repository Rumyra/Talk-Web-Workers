<!DOCTYPE html>
<html lang="en">
<head>
  <!--char set (lang above)-->
  <meta charset="utf-8">

  <!--device/browser shizzle-->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--meta content-->
  <link rel="shortcut icon" href="favicon.ico" />

  <meta name="author" content="Ruth John (@rumyra)">
  <meta name="dcterms.rightsHolder" content="Ruth John for Rumyra Ltd, United Kingdom, 2015">
  <title>Web Workers & Worklets</title>

  <link rel="stylesheet" href="reveal/css/reveal.css">
  <link rel="stylesheet" href="reveal/css/theme/rumyra.css" id="theme">
  <link rel="stylesheet" href="reveal/lib/css/eighties.css">
  <!-- <link rel="stylesheet" href="assets/audio.css"> -->
  <script src="reveal/js/reveal.js"></script>
  <script src="scripts/d3.min.js"></script>

  <!-- <script src="https://js.pusher.com/3.0/pusher.min.js"></script> -->
  <!-- <link rel="stylesheet" href="visuals.css"> -->

  <style type="text/css">
    #screen {
      position: absolute; top:0px; left:0px;
      margin: 0px; padding: 0px;
      width:100vw; height:100vh;
      background-color: black;
      display: none;
    }
    svg {width: 100vw; height: 100vh; padding:0px; margin:0px;}
  </style>

</head>

<!--

$green: #acc486
$orange: #ea8d88
$purple: #8c4c6f

$brown: #463c34
$cream: #eee5c4

$grey: #bebebe
-->

<body class="talk">
  <div class="reveal">
    <div class="slides">
      <section>

        <section data-background-color="#8c4c6f">
          <h1>Web Workers & Worklets</h1>
          <p>Ruth John&nbsp;&nbsp;|&nbsp;&nbsp;@Rumyra</p>
          <aside class="notes">
          </aside>
        </section>

        <section data-background-color="#8c4c6f">
          <h1>Ruth John&nbsp;&nbsp;|&nbsp;&nbsp;@Rumyra</h1>
          <p>Hello</p>
          <aside class="notes">
            <p>Hey everyone - I don't need to intro myself too much - you all know me from places such as...</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f" data-background-image="media/slack.png">
          <h1>Ruth John&nbsp;&nbsp;|&nbsp;&nbsp;@Rumyra</h1>
          <p>Hello</p>
          <aside class="notes">
            <p>Digital Oxford, jsoxford slack channel</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f" data-background-image="media/summer.png">
          <h1>Ruth John&nbsp;&nbsp;|&nbsp;&nbsp;@Rumyra</h1>
          <p>Hello</p>
          <aside class="notes">
            <p>js oxford summer of hacks</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f" data-background-image="media/gh.png">
          <h1>Ruth John&nbsp;&nbsp;|&nbsp;&nbsp;@Rumyra</h1>
          <p>Hello</p>
          <aside class="notes">
            <p>Well named pull requests on jsoxford website</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f">
          <h1>Ruth John&nbsp;&nbsp;|&nbsp;&nbsp;@Rumyra</h1>
          <p>Creative Engineer</p>
          <p>~ 15 Years</p>
          <p>Google Developer Expert</p>
          <aside class="notes">
            <p>I'm a creative engineer, legacy web dev. I've been doing this for about 15 years</p>
            <p>I'm a recognised Google Developer Expert in browser stuff and specifically audio and midi</p>
            <p>I work for myself - always on the look out for new projects</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f">
          <h1>Thanks for having me</h1>
          <img src="media/jo.jpg" />
          <img src="media/me.jpg" />
          <aside class="notes">
            <p>It is wonderful to be talking along side Jo this evening... for a number of reasons but one because:</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/seren.png">
          <aside class="notes">
            <p>I know the organisers did not plan to have a IWD themed jsoxford, which is the best thing. That the community here didn't try. I think this is the first meetup I have spoken at with an all female line up at IWD where it was natural.</p>
            <p>That, that's what it is about. That this is normal!</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88">
          <h1>Web Workers</h1>
          <h2>Full Disclosure</h2>
          <aside class="notes">
            <p>Longest intro ever!</p>
            <p>Web workers! yeah... let's start with the what, then the how, then what I really want to talk about which is owrkers in other specs.</p>
            <p>This is a brand new talk - I have never done it before, it is a first version so it is not a shiny end conference talk.</p>
            <p>I would luv afterwards (no q&a) afterwards to take feedback. What did you like, what didn't you like, could I have explained something better, was there anything you didn't understand</p>
            <p>Don't be scared I won't share that feedback, I will merely edit this talk</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/shaun.gif">
          <aside class="notes">
            <p>Cool</p>
          </aside>
        </section>

        <!-- <section data-background-color="#ea8d88">
          <h1>Web Workers</h1>
          <aside class="notes">

          </aside>
        </section> -->

        <section data-background-color="#ea8d88" data-background-video="media/lemSin.mov">
          <h1>Web Workers</h1>
          <aside class="notes">
            <p>Let's talk for a minute about the way the browser processes all that code you write</p>
            <p>JS is single threaded</p>
            <p>When the browser is processing the code it can only deal with running one process thread. This can take time.</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-video="media/lemMult.mov">
          <h1>Web Workers</h1>
          <aside class="notes">
            <p>Wouldn't it be cool if whilst that was going on, some of the things the browser had to do could happen else where, whilst the browser was still doing it's work.</p>
            <p>Seperately and at the same time</p>
            <p>That's what a web worker is - it take processing off the main thread, and puts it on another.</p>
            <p>Makes it multi threaded</p>
            <p>Now we'll talk about problems in a minute but let's take a look at how it works</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/lemShrug.gif">
          <h1>Web Workers</h1>
          <h3 class="fragment fade-in">Separate script in file</h3>
          <h3 class="fragment fade-in">Object: use <code>Worker()</code> constructor</h3>
          <h3 class="fragment fade-in">Run in another global context</h3>
          <aside class="notes">
            <p>Its separate js code that runs in a separate file</p>
            <p>You use the worker constructor to create the object and pass in the name of the file</p>
            <p>Run in another global context than window which main thread is - thus using window and not self within a worker will cause an error - window is not accessible from a worker</p>
            <p>Neither is the DOM - not available from the worker</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88">
            <pre><code data-trim class="js">// create a worker
var myWorker = new Worker('worker.js');
            </code></pre>
          <aside class="notes">
            <p></p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/lemStop.gif">
          <h1>Web Workers</h1>
          <h3 class="fragment fade-in"><code>window</code>, <code>document</code>, <code>parent</code> not avail</h3>
          <h3 class="fragment fade-in">No DOM</h3>
          <h3 class="fragment fade-in">Some cache</h3>
          <h3 class="fragment fade-in">There's <code>XMLHttpRequest</code></h3>
          <h3 class="fragment fade-in"><code>setTimeout()/setInterval()</code></h3>
          <h3 class="fragment fade-in">Import scripts & create other workers</h3>
          <h3 class="fragment fade-in">List: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Functions_and_classes_available_to_workers">https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Functions_and_classes_available_to_workers</a></h3>
          <aside class="notes">
            <p>This means that window, navigator and parent objects are not available (self is)</p>
            <p>Neither is the DOM it is not thread safe</p>
            <p>But there is limited access to other APIs and methods</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/lemShrug.gif">
          <h1>Dedicated Workers</h1>
          <h1>Shared Workers</h1>
          <aside class="notes">
            <p>I'm not going to go into this in too much detail - this talk is going to deal with dedicated workers and this is your read more homework</p>
            <p>Suffice to say a dedicated worker is called within the main script and destroyed when that script ends</p>
            <p>A shared worker does what is says on the tin, multiple pages can access it and you create it with a slightly different method.</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/lemShrug.gif">
          <h1>Terminating workers</h1>
          <h2>& Errors</h1>
          <aside class="notes">
            <p></p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/lemShrug.gif">
            <pre><code data-trim class="js">// error event
var myWorker = new Worker('worker.js');

myWorker.addEventListener('error', onError, false);

function onError(e) {
  // human readable message
  e.message
  // file error occurred
  e.filename
  // line num
  e.lineno
}

// kill a worker
myWorker.terminate();
            </code></pre>
          <aside class="notes">
            <p></p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/shaun.gif">
          <aside class="notes">
            <p>Cool</p>
          </aside>
        </section>


        <section data-background-color="#ea8d88">
          <h1>Pass some data</h1>
            <pre><code data-trim class="js">// send worker a message
myWorker.postMessage('Hey worker');
            </code></pre>

            <pre><code data-trim class="js">// in our worker.js
self.addEventListener('message', function(e) {
  // logs 'Hey worker'
  console.log(e.data);

  // send a message back
  self.postMessage('Hey main');
}, false);
            </code></pre>
          <aside class="notes">
            <p>OK so we not only have to give the worker data but we also have to start it - this happens with the same thing - postmessage method</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88">
          <h1>DEMO</h1>
            <pre><code data-trim class="js">// error event
var myWorker = new Worker('worker.js');
            </code></pre>
          <aside class="notes">
            <p></p>
          </aside>
        </section>


        <section data-background-color="#ea8d88">
          <h1>∞ processes</h1>
          <aside class="notes">
            <p>Now I know what some of you are thinking already - what if you have 100 of these workers, how is the processing going to be shared?...</p>
          </aside>
        </section>



        <!-- people are relunctant to use it on the web -->
        <section data-background-color="#eee5c4" data-background-video="media/cameronsworld.mp4">
          <aside class="notes">
            <p>Real website - camerons world</p>

            <p>A website playing background music - the modern version of which is something like this:</p>
            <p>Then there's the modern day equivilant.</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/annoy.mp4">
          <aside class="notes">
            <p>An annoying advert that autoplays - yes I know.</p>
            <p>http://afternooncareer.com/lp/int/uk/dn24/clx.htm</p>
            <p>I mean this is intrusive and pretty horrible, ur probably trying to read an article</p>
            <p>But actually there's some really great examples of audio just being used on plain ol' websites.</p>
            <p>If you're not a developer - I bet you know one - and I bet this is their reaction when you mention audio on the web - it might even be yours - I get it</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/erHmm.gif">
          <aside class="notes">
            <p>But neither of these cases need be a thing anymore. Background music on websites is, well pretty legacy - kid in sweet shop - and the browsers safari and chrome just put in measures to stop auto playing of videos </p>
            <p>estate agents website with regae</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/futureLibrary.mp4">
          <!-- future library -->
          <p>futurelibrary.no</p>
          <aside class="notes">
            <p>This is my favourite, this is a project from Norway called future library, where they're growing a forest and getting authors to write books for every tree and every year.</p>
            <p>Sounds are playing throughout, but beautiful & well thought out even mute fades it out</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/86years.mp4">
          <!-- portfolio -->
          <p>86andahalfyears.com</p>
          <aside class="notes">
            <p>This is 86 and half years. A story website about the musings of an 86 1/2 yesr old man. But presented so excellently.</p>
            <p>None of the sounds on these websites are intrusive, they enhance the experience, these aren't websites you flick to, or just read, you discover them. There is a place for audio here.</p>
            <p>The other barrier to entry with web & audio is the web audio API specification itself</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/specScroll.mp4">
          <aside class="notes">
            <p>This is the specification</p>
            <p>It's a spec unto itself really - by the way the length of that video before I sped it up was 2 1/2 mins!</p>
            <p>For those of you that aren't developers - this is silly long. Easily longest web api spec</p>
            <p>If you're not from a musical background it can be pretty intimidating to say the least - it's a reflection of sound engineering</p>
            <p>So this is amazing and stupid in equal mesures - to the point people started replicating hardware with it</p>
          </aside>
        </section>

<!--
        <section data-background-color="#eee5c4" data-background-video="media/mdnDocs.mp4">
          <aside class="notes">
            <p>MDN docs of methods, functions, properties, events. I mean what even is a cent. Top tip - it's not a denomination of a currency.</p>
            <p>Was this article helpful? To be honest it actually is. These docs are the most helpful. Go here.</p>
            <p>And because it's so big you can do so much cool stuff with it...</p>
          </aside>
        </section>
 -->


        <section data-background-color="#eee5c4" data-background-image="media/roland808.png">
          <aside class="notes">
            <p>There's this guy - Gregor Adams - he built an roland 808 to celebrate 808 followers on codepen, that was cool. And it's not just him, there's a growing trend I mean there are all these</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/novation.png">
          <aside class="notes">
            <p>synth</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/html909.png">
          <aside class="notes">
            <p>the</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background="media/viktor.png">
          <aside class="notes">
            <p>There are all these fabulous things being built with the web audio api</p>
            <p>But for now, back to audio... web audio. I mean look at this where do you even begin, it's big, it's complicated, you have to have a background in audio to begin to understand it.</p>
            <p>Let's take a whistle stop tour. And here in lies a basic coding lesson for a friday morning.</p>
          </aside>
        </section>



        <!-- the thing about coding is you can make what you want - you don't *have* to copy something that exists -->

        <!-- might do people started replicating synths - then do weird examples - keep why the web for the end -->

        <section data-background-color="#acc486" data-background="media/webLang.jpg">
          <h1><del>Digital Audio</del> Coding</h1>
          <p>A little lesson</p>
          <aside class="notes">
            <p>So this is the part of the talk where I give developers a little lesson in digital audio</p>
            <p>I don't think you need that - it's numbers, we know that, but let me give you a brief overview of web developement as I think that will be helpful</p>
            <p>Web pages are comprised of 3 languages HTML CSS JS - html presentation, css style, js interactivity & functionality.</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-background="media/webLangJS.jpg">
          <h1><del>Digital Audio</del> Coding</h1>
          <p>A little lesson</p>
          <aside class="notes">
            <p>Now js is key here - the history of js is key here. It started just as a sort of small loose layer to web pages - but it's sort of exploded over the past few years.</p>
            <p>The languages you see here are all client side - it's what the user sees and accesses. But there's also server side languages - php, ruby, .net. These all deal with or access data or functionality *not* on the client side</p>
            <p>Thing is js went server side a few years ago, people who did client side stuff where like super cool and people who did server side stuff were like super cool and now every writes javascript</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-background="media/jsEver.jpg">
          <h1>JS Everywhere</h1>
          <aside class="notes">
            <p>But that means that javascript sort of got everywhere - desktop, chromebook, hardware, switch</p>
            <p>And then JS arrived on the desktop</p>
            <p>And on the server</p>
            <p>And on the desktop electron and nwjs</p>
            <p>It's on hardware</p>
            <p>I found out this</p>
            <p>I found out this week you can put it on a switch</p>
            <p>JS is popular as a coding language - really popular</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-background="media/learn.jpg">
          <aside class="notes">
            <p>It's also not that hard to pick up if you wanted to learn a programming language</p>
            <p>Here's some places on the internet that you can do some tutorials and lessons for free.</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-background="media/apiLogo.jpg">
          <h1>The Web Audio API</h1>
          <!-- <svg id="wave-graph"></svg> -->
          <aside class="notes">
            <p>Web Audio API is an Application Program Interface</p>
            <p>It a whole bunch of functionality that comes with the browser and we can access with javascript</p>
            <p>Now I've tried to pick out the main bits - I can't get all of it in a talk. I guess some of you know all of this - let's play a game - let's get Ruth to go over the whole of the web audio api in ten minutes</p>
            <p>Now I am going to show you a whole heap of code - it's legit - don't leave there's more to come after I do this</p>
          </aside>
        </section>


        <!-- <section data-background-color="#eee5c4">
          <h1>Loading & Playing Sounds</h1>
          <aside class="notes">
            <p>Now let's say you want to load a sound to use - this can be for anything, website, app, your crazy synth, you have to make sure the audio api can understand this data</p>
            <p>So here comes the code - are you ready? The first thing we have to do is create an instance of the api to use it</p>
          </aside>
        </section> -->

        <!-- create new audio api - recording studio -->
        <section data-background-color="#463c34">
          <h1>Audio Context</h1>
          <pre><code class="js">const context = new window.AudioContext</code></pre>
          <aside class="notes">
            <p>So let's begin - the first thing we need to do...</p>
            <p>Here I'm creating an instance of the audio context to be used within my application - I only need to do this once, this is the audio api. It gives me all the methods I'm going to need in endless supply.</p>
            <p>The context is sort of the area where everything happens.</p>
            <p>Think of it like a recroding studio. Instruments, mixing desks, effects.</p>
            <p>prefix still needed in safari everyone</p>
          </aside>
        </section>

        <section data-background-color="#463c34">
        <h1>Loading Sounds</h1>
        <pre><code data-trim class="js">// DOM (audio, video element)
const mediaSource = context.createMediaElementSource(element);

// Streams (data, camera, mic)
const streamSource = context.createMediaStreamSource(stream);

// Buffer (file, data)
fetch('soundFile.mp4')
  // read into memory as array buffer
  .then(response => response.arrayBuffer())
  // turn into raw audio data
  .then(arrayBuffer => context.decodeAudioData(arrayBuffer))
  // then play (see https://jakearchibald.com/2016/sounds-fun/)
          </code></pre>
          <aside class="notes">
            <p>Once you have that, you need some sounds.</p>
            <p>Let's start with loading sounds - on a website this is important.</p>
            <p>There are three main ways of loading sounds into this context.</p>
            <p>buffers are containers data - samples. sample rate. create your own. Files are compressed, mp3, m4a, FLAC.</p>
            <p>With the top two we by pass the buffer stuff, but there's no preload - when we fetch the file in the last method we load it into memory and get retreive it at any time. As a rule top one for not many and long tracks. Middle for streams, last for lots of short sounds.</p>
          </aside>
        </section>

        <section data-background-color="#463c34">
        <h1>Play Sounds</h1>
        <pre><code data-trim class="js">// connect to output
source.connect(context.destination);

// start our sound!
source.start();
          </code></pre>
          <aside class="notes">
            <p>Once you've got your sound we need to play it. This means connect it to the speakers and set it to play.</p>
            <p>There's a couple more destinations, speakers are default. There's stream destination using MediaStream API, so you can broadcast to peers with Web RTC, or save to file, or you can collect the data in a buffer.</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-state="play-arps">
        <h1>Play Sounds</h1>
        <button data-sound="play-arps">Arps</button>
          <aside class="notes">
            <p>[q] Now using the code that we have just seen, I've done this. I've got a sound, I've loaded it into a buffer, attached it to an event listener so I can set it to play when the button is pressed.</p>
            <p>Great</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-background-image="media/aGraph1.png" data-state="stop-arps">
        <h1>Audio Graph & Nodes</h1>
        <!-- picture of graph here -->
          <aside class="notes">
            <p>So this is our audio graph so far - we refer to each of our parts as nodes - we have input & output and the majority of whats left are modification.</p>
            <p>If you open firefox dev tools you get this</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-background-image="media/mute.jpg" class="lists">
          <div class="list-left">
            <h2>Mute 👍</h2>
          </div>
          <div class="list-right">
            <h2>No mute 👎</h2>
          </div>

          <!-- mute controls -->
          <aside class="notes">
            <p>Mute is important on the internet</p>
            <p>If we look back at our previous examples, forest does this well, 86years not so mcuh</p>
            <p>Regardless we can add that - there's a gain node</p>
          </aside>
        </section>

        <section data-background-color="#463c34">
        <h1>Mute: Gain Node</h1>
        <pre><code data-trim class="js">// create gain node
const gainNode = context.createGain();

// set value
gainNode.gain.value = 0;

// connect our nodes together
source.connect(gainNode).connect(context.destination);

source.start();
          </code></pre>
          <aside class="notes">
            <p>What we do is create one...</p>
            <p>This controls volume. 0 value is nothing, 1 value is normal. 0.5 half. By setting it to 0 it will mute our audio. We can set this value to anything.</p>
            <p>Need to connect it.</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-state="mute-arps">
        <h1>Mute Sounds</h1>
        <button data-sound="arps" data-mute="undef">Arps</button>
          <aside class="notes">
            <p>[w] Now using the code that we have just seen, I've done this. I've got a sound, I've loaded it into a buffer, attached it to an event listener so I can set it to play when the button is pressed.</p>
            <p>Great</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-background-image="media/aGraph2.png">
        <h1>Our Audio Graph</h1>
        <!-- picture of graph here -->
          <aside class="notes">
            <p>Going back to our audio graph - this is what it looks like now. See it has our effect node in the middle, our gain node.</p>
          </aside>
        </section>

        <!-- portfolio example -->
        <!-- volume, anything else? Timing - jakes article - library -->

        <section data-background-color="#463c34">
          <h1>Alter sounds</h1>
          <pre><code data-trim class="js">// even out velocity
var compressor = context.createDynamicsCompressor();
// set values threshold, knee, ratio, reduction, attack, release

// delay sound
const delay = context.createDelay(5.0);
          </code></pre>
          <aside class="notes">
            <p>Here are some other simple nodes we can use to modify sounds.</p>
            <p>Ear is a clever thing, it can here very quiet sound & very loud sounds. It evens them out for you. It's a very good dynamic compressor.</p>
            <p>Panner takes into account distance, orientation adn 3D space. There's a whole bunch of params to set for this one - I strongly suggest looking at the docs.</p>
          </aside>
        </section>

        <!-- But what if you do want to create your own sounds, or make your own sound machine - 4th way -->
        <section data-background-color="#463c34" data-state="osc">
        <h1>Make Sounds</h1>
        <pre><code data-trim class="js">// waveform
const oscillator = context.createOscillator();
oscillator.type = 'triangle';
oscillator.frequency = 440;

// custom waveform
var wave = context.createPeriodicWave(real, imag, constraints);
oscillator.setPeriodicWave(wave);
          </code></pre>
          <aside class="notes">
            <p>[e] Instead of loading sounds, like we saw before, we can create them. There's an osciallator node. The sin wave you saw ealier, this can create one of those.</p>
            <p>It can also create a number of default waves (specifically ones that are easy to generate) - square, triangle and sawtooth.</p>
            <p>You can even make your own wave form to be generated. The PeriodicWave interface defines a periodic waveform that can be used to shape the output of an OscillatorNode.</p>
            <p>This sounds a bit like this 'e'</p>
          </aside>
        </section>

        <!-- <section data-background-color="#acc486">
        <h1>Oscillator</h1>
        <button data-sound="osc">Oscillator</button>
          <aside class="notes">
            <p>This is an oscillator - it doesn't really sound like much, but if we change a few params and add a gain like we did earlier we can do some fun stuff with it.</p>
            <p>Great</p>
          </aside>
        </section> -->

        <section data-background-color="#463c34">
        <h1>Built in stuff</h1>
        <pre><code data-trim class="js">// jump frequency down
oscillator.frequency.exponentialRampToValueAtTime(10,
  context.currentTime+1);

// jump volume down too!
gainNode.gain.exponentialRampToValueAtTime(0.001,
  context.currentTime+0.9);
          </code></pre>
          <aside class="notes">
            <p>The audio api comes with some nice methods use on parameters - here's a good one - I use it commonly, so I wanted to share it.</p>
            <p>exponential ramp to value at time</p>
            <p>changes the value of the node at a set time - use it on frequency of osc AND if we create a gain node before, change volume</p>
            <p>also linear value at time method. Exponential ramp is curve & nicer to hear.</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-state="laser">
        <h1>Laser</h1>
        <button data-sound="laser">Laser</button>
          <aside class="notes">
            <p>[t] So by simply adding a bit of built in functionality - boom we have a laser. With an oscillator.</p>
          </aside>
        </section>

        <!-- maybe put kick example in here -->

        <!-- <section data-background-color="#ea8d88" data-background-image="media/tuna.png" data-transition="none">
          <h1>Tuna</h1>
          <aside class="notes">
            <p>Tuna - sound effects library. Useful for games.</p>
            <p>The other way to create sounds is to create your own data for a buffer rather than an oscialltor.</p>
          </aside>
        </section> -->

        <section data-background-color="#463c34" data-state="white">
        <h1>Buffers</h1>
        <pre><code data-trim class="js">// make your own!
const node = context.createBufferSource(),
  buffer = context.createBuffer(channels, frameCount, sampleRate),
  data = buffer.getChannelData(0);

for (var i = 0; i < 4096; i++) {
 data[i] = Math.random();
}

node.buffer = buffer;

// thanks http://www.justgoscha.com/programming/2014/04/08/creating-dynamic-audiobuffers-with-webaudio.html
          </code></pre>
          <aside class="notes">
            <!-- play noise here? -->
            <p>[g] That audio buffer we passed the file data into earlier, to load the file. We don't have to load a file into a buffer, we can create that data ourselves. We know now it's just numbers.</p>
            <p>The loop you see in the code here creates numbers that when passed into the buffer and played play white noise.</p>
            <p>Are you ready it doesn't sound great. </p>
            <p>Pink noise is better than white noise, it's softer, it reduces the harsher tones, we can use a function for that, or we can use another of the built in methods the api gives us.</p>
            <p>And this is where we can really start to have some fun with the other filter nodes the api gives us.</p>
          </aside>
        </section>


        <section data-background-color="#463c34" data-state="pink">
          <h1>Alter sounds</h1>
          <pre><code data-trim class="js">// filter/accentuate frequencies
const biquadFilter = context.audioCtx.createBiquadFilter();
biquadFilter.type = "lowpass";
biquadFilter.frequency.value = 500;

// manipulate waveform
const shaper = context.createWaveShaper();
shaper.curve = someCraMathsFunction();

// repeat buffer data
const reverb = context.createConvolver();
// fetch file to use as buffer or make here ...
reverb.buffer = bufferedFile;
          </code></pre>
          <aside class="notes">
            <p>[h] Here are some ways to alter sounds - remember these can be used on any nodes.</p>
            <p>Biquad filter - algorithms on data - to enhance frequencies or filter them out. There's lots of types. High pass, low pass, high shelf, low sheif, peaking</p>
            <p>Defines an array of numbers to multiply to the sample</p>
            <p>often generated by recording a percussive noise or frequency sweep in a space. Does this all sound convoluted? Well, technically, it is!</p>
            <p>If we put a bandpass type biquad filter on the white noise it now sounds like this:</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-state="snare">
        <h1>Snare</h1>
        <button data-sound="snare">Snare</button>
          <aside class="notes">
            <p>[y] Then if we do what we did before and add a little gain drop odd - boom, we got a snare!</p>
          </aside>
        </section>

        <section data-background-color="#463c34">
          <h1>Timing</h1>
          <pre><code class="js">const now = context.currentTime</code></pre>
          <aside class="notes">
            <p>See loads of code!</p>
            <p>Timing is super important in audio. Whether you're just loading in and playing sounds, or you do want to take it further.</p>
            <p>In web audio we have this currentTime property on the context itself. It accesses the audio subsystems hardware clock.</p>
            <p>The web audio Api has a currentTime property. This starts when you instigate the api right at the start, but it uses system hardware for the clock and can be used as a benchmark all the way through. So let's say we load in a hi hat sound. We can simple create a loop and using currentTime, we can play the hi hat four times equally ina loop.</p>
            <p>Music works like this, it has beats and these are mad eup into bars. Sometimes you have 4 beats in a bar, sometimes 3, sometimes two, sometimes 8 half beats. It's all just maths.</p>
            <p>Long story short - we don't have to use javascript timing functions - which are dodgy.</p>
            <p>Gives u benchmark throughout</p>
          </aside>
        </section>

        <section data-background-color="#acc486" data-state="hi-hat">
        <h1>Hi Hat</h1>
        <button data-sound="hh">Hi Hat</button>
          <aside class="notes">
            <p>[u] Then if we do what we did before and add a little gain drop odd - boom, we got a snare!</p>
          </aside>
        </section>

        <section data-background-color="#463c34">
          <h1>Audio Worklets</h1>
          <p> googlechromelabs.github.io/web-audio-samples/</p>
          <pre><code class="js">let worklet = new AudioWorkletNode(context, 'worketModule');
source.connect(worklet).connect(context.destination);</code></pre>
          <aside class="notes">
            <p>They're kinda here</p>
            <p>So this takes all that number crunching off the main thread too - there's a few bits and bobs being done at the moment in regards to number crunching, better syntax</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/fistBump.gif">
          <aside class="notes">
            <p>Well done everyone - fist bump!</p>
            <p>Cos we haven't seen enough code right!</p>
            <p>So wait - I think we might have just created a sound, a laser, and a drum kit... it's almost like we've created a mini synth, in 35 minutes. Now I have 10 to control it!</p>
            <p>Super cool great - but I haven't shown you anything you can't do with hardware, or already existing software</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88">
          <h1>Reason #1</h1>
          <p>Interface</p>
          <aside class="notes">
            <p>True, but let's think back to the top of our coding lesson - we have all this functionality specifically paired with two other languages, one for content and one for style</p>
            <p>So people are building already existing synths</p>
            <p>But people are also re-inventing the synth</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/block.mp4">
          <aside class="notes">
            <p>This is blokdust. Built by Luke Twyman, Luke Phillips and Edward Silverton in Brighton.</p>
            <p>It's well mental. A beautiful interface for a synth - you just pull things in, sound inputs, add effects, chain them together and output them. You can add controls.</p>
            <p>Note this interface - it'll be important later.</p>
            <p>And it's not just synths & appeGiators - there's art too</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/mod.mp4">
          <p>mod-synth.io</p>
          <aside class="notes">
            <p>Probably based heavily on mod-synth.io which came before and is similar</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/dotPiano.mp4">
          <p>dotpiano.com</p>
          <aside class="notes">
            <p>But then there's simpler things - like just visualising a piano</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88">
          <h1>Reason #2</h1>
          <p>Reach</p>
          <aside class="notes">
            <p>It's the web</p>
            <p>It's literally in everyones pockets - most people world wide have access to the platform we can run this on</p>
            <p>This means we can educate</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/abletonSite.jpg">
          <!-- ableton learn music -->
          <p>learningmusic.ableton.com</p>
          <aside class="notes">
            <p>What you thought I'd come to abletons conf and not give a shout out to their own website</p>
            <p>It's lovely - it's hard enough to make a website without making it this good</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/playDrums.jpg">
          <!-- ableton learn music -->
          <p>playdrumsonline.com/</p>
          <aside class="notes">
            <p>There's also play drums online which attempts to allow you to hook up your drum kit and ply it along with you tube videos</p>
          </aside>
        </section>


        <section data-background-color="#ea8d88">
          <h1>Reason #3</h1>
          <p>Connectivity</p>
          <aside class="notes">
            <p>Connectivity</p>
            <p>It's the web - it's talking to the rest of the web!</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/type.mp4">
          <p>https://typatone.com</p>
          <aside class="notes">
            <p>You can send messages that have sound in them</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/mixanalogue.png">
          <p>mixanalog.com</p>
          <aside class="notes">
            <p>If you'd rather be making music maybe mix analogue is your thing</p>
            <p>It allows you to rent hardware remotely - so you book it and upload your sound and use a software interface to control remote hardware</p>
          </aside>
        </section>

        <!-- demos! -->


        <section data-background-color="#ea8d88">
          <h1>Reason #4</h1>
          <p>All the other things</p>
          <aside class="notes">
            <p>The web audio API isn't the only API we get in this environment - it's not the only thing we get to play with. And I mean without adding anything else</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/browserapis.jpg">
          <h1>Browser APIs</h1>
          <aside class="notes">
            <p>And I mean all the other things - this is just a handful of what the browser gives you</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/threea.jpg">
          <h1>Web GL</h1>
          <h2>three.js & A-Frame</h2>
          <aside class="notes">
            <p>We have web GL - basically 3D</p>
            <p>Both three.js and a-frame include this panner functionality. So you can position audio within your 3d space when using those libraries.</p>
            <p>I lied when I said we had covered the api - of course we hadn't - it's freakin huge</p>
          </aside>
        </section>

        <!-- panning, spatialisation, sound spriting -->
        <section data-background-color="#463c34">
          <h1>Spatialisation</h1>
          <pre><code data-trim class="js">// create panner node
const listener = context.listener;
const soundSource = context.createPanner();

// set positions
listener.setPosition(0, 0, 0);
soundSource.setPosition(0, 0, 0);

// also set orientation, velocity, cones of panner
          </code></pre>
          <aside class="notes">
            <p>Spatialisation, I'm making sound, person listing, I move, sound moves. This emulates it.</p>
            <p>This is the aptly named panner node.</p>
            <p>3D sound scape to work with.</p>
            <p>Create sound source - where sound is coming from and a listener, where it is picked up from.</p>
            <p>We can make sounds appear as if they are infront or you, above you, to the left to the right.</p>
            <p>Cones are like lights - ambient and spotlight.</p>
            <p>PROPERTIES! on SOURCE</p>
          </aside>
        </section>
        <!-- VR example? or phone -->
        <!-- <section data-background-color="#acc486" data-state="space">
          <h1>Demo</h1>
          <div id="space">
            <span data-object="source"></span>
            <span data-object="listener"></span>
          </div>
          <aside class="notes">
            <p>A frame?</p>
          </aside>
        </section> -->

        <section data-background-color="#ea8d88" data-background-image="media/resonance.png">
          <!-- ableton learn music -->
          <p>developers.google.com/resonance-audio/</p>
          <aside class="notes">
            <p>Google just released a cross platform 'resonance audio' development kit because VR has gotten so popular - to answer the we need audio in a 3D environment box</p>
            <p>The bit for the web actually just puts a layer on top of the audio api - but it's kinda nice - before for the space you just had to play with numbers and now you get to set a room so that's pretty cool</p>
          </aside>
        </section>

        <section data-background-color="#463c34">
          <h1>Stereo Panner</h1>
          <pre><code data-trim class="js">
// simple stereo panning
const simplePanner = context.createStereoPanner();
          </code></pre>
          <aside class="notes">
            <p>Here are some other simple nodes we can use to modify sounds.</p>
            <p>Ear is a clever thing, it can here very quiet sound & very loud sounds. It evens them out for you. It's a very good dynamic compressor.</p>
            <p>Panner takes into account distance, orientation adn 3D space. There's a whole bunch of params to set for this one - I strongly suggest looking at the docs.</p>
          </aside>
        </section>

        <section data-background-color="#ea8d88" data-background-image="media/harry.png">
          <!-- portfolio -->
          <h1>Pottermore</h1>
          <p>my.pottermore.com/hogwarts</p>
          <aside class="notes">
            <p>The latest harry potter site - for pottermore - integrates 3d on the web (web gl) and thus environment sound effects along side background music</p>
            <p>No one seems to mind if it's 3D right :)</p>
            <p>So how is this now possible with the death of flash?</p>
            <p>Web audio thus 2nd problem</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f">
          <h1>MIDI</h1>
          <aside class="notes">
            <p>The web midi api is a different api altogether and I will explain why...</p>
            <p>This is literally my favourite subject</p>
            <p>This is not MIDI...</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f" data-background-image="media/controllers.jpg" data-transition="none">
          <aside class="notes">
            <p>We can hook up any MIDI instrument or controller to our browser - seriously</p>
          </aside>
        </section>

        <section data-background-color="#463c34">
          <h1>Web MIDI API</h1>
          <h2>[144, 60, 100]</h2>
          <pre><code data-trim>// call requestMIDIAccess
navigator.requestMIDIAccess({ sysex: false }).then(onMIDISuccess, onMIDIFailure);

// on success of MIDI device recognised
function onMIDISuccess(midiControl) {
  var MIDI = midiControl;

  // log each input data
  MIDI.inputs.forEach(function (input) {
    console.log(input.onmidimessage.data)
  }
}
          </code></pre>
          <aside class="notes">
            <p>You make sure it’s avail, listen for attached device, when plugged in you can receive these afore mentioned messages. All I’m doing here is logging those messages - you can do whatever you want with them. Notice the sysex false - this is related to system messages and I will get back to that in a moment.</p>
            <p>Now there’s a window of opportunity - there’s plenty of stuff we can start coding with that!</p>
            <p>But what are these values?</p>
            <p>the first byte 144 is the message type and channel, 144 is 90 in hex and the 9 says it's a 'Note on' message and the 0 is the channel number. A 'Note on' message has two data bytes, the first is the 'key number' which I'm guessing is the note number, so 60 would be C the second is 'note on velocity' and this has a value of 100, - 0-127 (I'm guessing this means the rate at which the note is turned on)</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f">
          <h1>Demo</h1>
          <p data-height="697" data-theme-id="1345" data-slug-hash="NxdbzL" data-default-tab="result" data-user="Rumyra" data-embed-version="2" class="codepen">See the Pen <a href="http://codepen.io/Rumyra/pen/NxdbzL/">Web MIDI API Example</a> by Rumyra (<a href="http://codepen.io/Rumyra">@Rumyra</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<script async src="//assets.codepen.io/assets/embed/ei.js"></script>
          <aside class="notes">
            <p>So if I plug in a MIDI instrument or controller and instigate the web MIDI api in my brwoser - this is the data you'll get</p>
            <p>You should all see a keyboard - one of the most common MIDI enabled instruments. Now this is the data that the web MIDI api passes back to us when a MIDI device is plugged in. So let's take a look at the code.</p>
            <p>SHUT THESE NOTES DOWN!</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f" data-background-image="media/madeon.png">
          <p>madeon.fr/adventuremachine</p>
          <aside class="notes">
            <p>I mean god forbid you build a website that you can control with a midi controller</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-video="media/typeMidi.mp4">
          <p>Laurie Cape</p>
          <aside class="notes">
            <p>or in fact use it for meaningless things like this guy who's literally just trying out font styles</p>
            <p>and with all these things I wouldn't even dare think about how there's no piece of software on the market that satisfy's both your making music and playing live needs so you build your own - which is exactly what Matt McKegg did</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/loopDrop.jpg" data-state="no-visuals">
          <p>Loop Drop</p>
          <aside class="notes">

          </aside>
        </section>

        <section data-background-color="#ea8d88" data-state="vis_canvas">
          <aside class="notes">
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/modV.jpg" data-state="no-visuals">
          <p>Mod V</p>
          <aside class="notes">
            <p>and I didn't even get to start about analysing audio - cos you can do that too and then make visuals - that's super cool!</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/dmxPen.jpg">
          <p>DMX Pen</p>
          <aside class="notes">
            <p>Martin Schuffhaus' DMX pen - which controls DMX using MIDI and all the other web technology</p>
            <p>Remember I said CSS was styles - he changes colours in CSS and the colours of the lights change</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/asia.jpg">
          <h1>{ Live : JS }</h1>
          <aside class="notes">
            <p>Then imagine if you all found each other on this thing called the internets - cos they're cool and then got together and started playing live shows</p>
            <p>With hand coded software powering everything - music lights projections - the works</p>
          </aside>
        </section>

        <section data-background-color="#eee5c4" data-background-image="media/livejs.jpg">
          <h1>livejs.network</h1>
          <aside class="notes">
            <p>Well we did that - all because once upon a time we decided to learn how to build websites</p>
          </aside>
        </section>


        <!-- <section data-background-color="#eee5c4" data-background-image="media/piano.jpg">
          <aside class="notes">
            <p>And there's not just websites or codepens</p>
            <p>This is piano - an art installation built with three.js and p5.js by Patrik Hubner - it harnesses web audio and web midi.</p>
            <p>An audio visualisation is displayed in a window and MIDI controller used to by passers by to interact with it.</p>
          </aside>
        </section> -->


        <section data-background-color="#8c4c6f">
          <h1>Audio & Web</h1>
          <aside class="notes">
            <p>I know there are other codes out there</p>
            <p>I know you can add javascript to max - I knwo you can do a lot of the art demos with processing. But you add a lot of stuff for very little gain</p>
            <p>What comes out of the box with a browser is fascinating</p>
            <p>I became a web developer 15 years ago after studying degree called Entertainment Technology - music tech, film, 3D, animation. Never in those early years did I think I'd be circling back around</p>
            <p>Never did I think I would have the tools at my fingers tips to be building the software I'd be using - you can bet on other things, but I'm pretty happy I bet on the web</p>
          </aside>
        </section>

        <section data-background-color="#8c4c6f" data-state="no-visuals">
          <h1>Go Forth&nbsp;&nbsp;|&nbsp;&nbsp;Make Noise</h1>
          <h1>Ruth John</h1>
          <h1>@Rumyra</h1>
          <p>Thank You Very Much</p>
          <aside class="notes">
            <p>Thank you very much, I'm Ruth John</p>
            <p>All these examples you've seen are on codepen as part of codevember</p>
            <p>Go have a relax and I hope you had a lovely conference!</p>
          </aside>
        </section>
        <!-- conslusion -->
        <!--  -->
        <!-- support for music file types -->






        <!-- <section data-background-color="#463c34">
          <h1>Analyse sounds</h1>
          <pre><code data-trim class="js">// frequency & time
const analyserNode = context.createAnalyser();

// larger for more resolution
analyser.fftSize = 1024;

var dataArray = new Uint8Array(2048);
// pass values into dataArray
analyser.getByteFrequencyData(dataArray);
          </code></pre>
          <aside class="notes">
            <p>This is my all time favourite feature. No doubt!</p>
            <p>We can anlayse frequency and time.</p>
          </aside>
        </section> -->


        <!-- <section data-background-color="#ea8d88" data-background-image="media/library.jpg">
          <h1>Audio Libraries</h1>
          <aside class="notes">
            <p>You're probably not gonna see much MIDI but audio is big in HTML games.</p>
            <p>This was actually quite tricky for me. I don't play games and if you google there's loads of Audio games - but they're not necessarily web.</p>
            <p>So I asked my friend.</p>
          </aside>
        </section> -->

        <section data-background-color="#8c4c6f" class="lists">
          <div class="list-right">
            <h1>Resources</h1>
            <ul>
              <li><h2><a href="https://www.html5rocks.com/en/tutorials/audio/scheduling/">Chris Wilson: A Tale of Two Clocks</a></h2></li>
              <li class="fragment fade-in"><h2><a href="https://www.html5rocks.com/en/tutorials/webaudio/intro/">Boris Smus: Getting Started with Web Audio API</a></h2></li>
              <li class="fragment fade-in"><h2><a href="https://dev.opera.com/articles/drum-sounds-webaudio/">Chris Lowis: Sythesising Drum Sounds</a></h2></li>
              <li class="fragment fade-in"><h2><a href="https://jakearchibald.com/2016/sounds-fun/">Jake Archibald: Sounds Fun</a></h2></li>
            </ul>
          </div>
          <aside class="notes">
            <p>As well as the libraries I mentioned earlier there's a few articles worth noting</p>
            <p>Chris Wilson explains time really well</p>
            <p>A couple of articles on using the api for game dev - boris smus on html5 rocks and one on MDN</p>
          </aside>
        </section>



        <section data-background-color="#8c4c6f" data-state="no-visuals">
          <h1>Credits</h1>
          <h3>@jsoxford hack photo: @spikeheap</h3>
          <h3>Apeggiator: https://codepen.io/jakealbaugh/pen/qNrZyw</h3>
          <h3>Blokdust: https://blokdust.com/</h3>
          <h3>Piano: https://www.patrik-huebner.com/portfolio-item/piano-3d-audio-reactive-typography/</h3>
          <aside class="notes">

          </aside>
        </section>

<!-- THIS IS IMPORTANT "0x" + x.toString(16); -->
      </section>
    </div></div>

    <div id="screen"></div>

<script src="reveal/plugin/notes/notes.js"></script>
<script src="reveal/plugin/highlight/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="scripts/talkEvents.js"></script>

<script type="text/javascript">
// Reveal~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


</script>


</body>
</html>